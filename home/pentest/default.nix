{ pkgs, ...}:

{
    # Allow unfree
    # nixpkgs.config.allowUnfree = true;
    home-manager = {
        users.tokugero = { pkgs, ... }: 
        {
            home = {
                packages = with pkgs; [
                    aircrack-ng
                    amass
                    burpsuite
                    dirb
                    exiftool
                    gdb
                    ghidra
                    gobuster
                    hashcat
                    john
                    kismet
                    metasploit
                    freerdp
                    mimikatz
                    netcat
                    nikto
                    nmap
                    pwndbg
                    python312Packages.impacket
                    radare2
                    rustscan
                    sherlock
                    sqlmap
                    steghide
                    tcpdump
                    thc-hydra
                    wireshark
                    wordlists # wordlists_path
                    zap
                ];
            };

        };
        useGlobalPkgs = true;
    };
    environment.systemPackages = with pkgs; [
        xrdp
    ];

    services.xrdp = {
        enable = true;
        defaultWindowManager = "startplasma-x11";

        extraConfDirCommands = ''
            substituteInPlace $out/xrdp.ini \
                --replace 'crypt_level=high' 'crypt_level=low' \
                --replace '#tcp_send_buffer_bytes=32768' 'tcp_send_buffer_bytes=4194304'
                
        '';
    };
}
